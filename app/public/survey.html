<!DOCTYPE html>
<html>
<head>
	<title>Friend Finder - Survey</title>
	
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
</head>
<body>
	<div class="container">
		<div class="page-header">
			<h1>Friend Finder <small>Survey Questions</small></h1>
		</div>
		<div class="page-header">
			<h3>About You</h3>
			<form class="form-horizontal">
				<div class="form-group">
					<label for="inputName" class="col-sm-2 control-label">Name (Required)</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="inputName">
					</div>
				</div>
				<div class="form-group">
					<label for="inputPicURL" class="col-sm-2 control-label">Link to Photo Image (Required)</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="inputPicURL">
					</div>
				</div>
			</form>
		</div>
    </div>

    <button id="submit">Submit</button>

<script>
// var scores = [];





var allQuestions = [
    "You usually plan your actions in advance", 
    "You trust reason rather than feelings",
    "You believe the best decision is one which can be easily changed",
    "You experience your emotions intensely",
    "You like to solve complex problems",
    "You like being the center of attention",
    "You believe criminals should receive help rather than punishment",
    "You believe in the importance of art",
    "You become overwhelmed by events",
    "You daydream often"
];

var choices = [
	"Strongly Disagree", "Somewhat Disagree", "Not Sure", "Somewhat Agree", "Strongly Agree"
];

function appendText() {
	for(i = 0; i < allQuestions.length; i++){
	    var quesHeader = $("<h3></h3>").text("Question " + (i + 1));
	    var question = $("<h4></h4>").text(allQuestions[i]);
	    $(".container").append(quesHeader, question);
	    answerChoices(i);
	}
}

function answerChoices(questionNum){
	for(j = 0; j < 5; j++){
		var divInput = "<div class='radio'><label><input type='radio' id='answ" + (questionNum + 1) + "' name='answ" + (questionNum + 1) + "' value='" + (j + 1) + "'>" + choices[j] + "</label></div>";
	    $(".container").append(divInput);  
	}
}

appendText();

$("#submit").click(function(){
   	var newFriend = {
		name: $("#inputName").val().trim(),
		photo: $("#inputPicURL").val().trim(),
		scores: []
	}

	for(i = 0; i < allQuestions.length; i++){
		if($("#answ" + (i + 1) + ":checked").val()){		    	
			newFriend.scores[i] = parseInt($("#answ" + (i + 1) + ":checked").val());
    		}
		else if (!$("#answ" + (i + 1) + ":checked").val()){
			alert("Please answer all questions");
			return;
		}
	}
    friendQuery(newFriend.scores);
});

function friendQuery(newScores){
	var currentURL = window.location.origin;
	$.ajax({url: currentURL + "/api/friends", method: "GET"}) 
		.done(function(friendData) {
			for(i = 0; i < friendData.length; i++) {
				var friendScore = friendData[i].scores;
				var totalDif = 0;
				console.log(friendData[i].name + ": " + friendScore);
			    console.log("Your Score: " + newScores);
			    var compare = [];
			    for(j = 0; j < 10; j++){
			    	compare[j] = Math.abs(friendScore[j] - newScores[j]);
					totalDif += compare[j];
					console.log(totalDif);
					console.log(compare[j]);
			    }
				console.log(compare);
				console.log(friendData[i].name + " Compatibility: " + totalDif);
			}
		});

}
</script>
</body>
</html>